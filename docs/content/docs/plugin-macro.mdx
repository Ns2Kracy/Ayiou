---
title: Plugin 宏
description: 使用 #[derive(Plugin)] 快速定义插件
---

`#[derive(Plugin)]` 会为你的结构体自动实现 `ayiou::core::plugin::Plugin`。

## 基本用法

```rust
use ayiou::prelude::*;

#[derive(Plugin)]
#[plugin(name = "my_plugin", command = "hello", prefix = "/")]
struct MyPlugin;

impl MyPlugin {
    async fn execute(&self, ctx: &Ctx) -> anyhow::Result<()> {
        ctx.reply_text("hello").await?;
        Ok(())
    }
}
```

## 属性说明

| 属性 | 说明 |
|---|---|
| `name` | 插件名（默认 struct 名小写） |
| `description` | 描述 |
| `version` | 版本（默认 `0.1.0`） |
| `command` | 命令名（可重复） |
| `prefix` | 插件命令前缀（可重复） |
| `regex` | 正则匹配模式 |
| `cron` | cron 表达式（仅表达元数据，不等于自动调度） |
| `context` | 自定义上下文类型 |

## context 示例

```rust
#[derive(Plugin)]
#[plugin(
    name = "console_help",
    command = "help",
    context = "ayiou::adapter::console::ctx::Ctx"
)]
struct ConsoleHelp;
```

## 何时用 #[bot_plugin]

`#[derive(Plugin)]` 适合简单插件。若一个插件管理多个命令，推荐使用 `#[bot_plugin] + #[command]`（见「命令系统与 DX」）。
